import unittest
import json

from appsync.util import urlb64decode


assertion = """\
eyJjZXJ0aWZpY2F0ZXMiOlsiZXlKaGJHY2lPaUpTVXpFeU9DSjkuZXlKcGMzTWlPaUppY205M2MyVnlhV1F1YjNKbklpd2laWGh3SWpveE16SXhOalExT0RreU9Ua3hMQ0p3ZFdKc2FXTXRhMlY1SWpwN0ltRnNaMjl5YVhSb2JTSTZJbEpUSWl3aWJpSTZJall5TmpNNE5UZzVNREF4TlRFek1qTXhNVGMxT1RjeE5UUXdNVGMwTlRjNE5qQXlNREF3T0RVeU9EY3dORGsxT0RjeU9EY3pNVGMxTXprME9UVXdOemN4TlRJMU5USXlOakk1TWpNek5qRXpNREF3TkRBek5EZzFNemMyTXpFek5qTTFNakl3TXpFd05qTTJNemMwTkRjd05ESXlOemcwTVRjeE9ETTJNRFl3TlRrNE56YzFOVGt3T1RjeU5UTTFOalE1TWpjd05EQTNOemNpTENKbElqb2lOalUxTXpjaWZTd2ljSEpwYm1OcGNHRnNJanA3SW1WdFlXbHNJam9pZEdGeVpXdEFiVzk2YVd4c1lTNWpiMjBpZlgwLnBqTjFXekc1YkxKR1U3RTlTYmVjbkZhZUpkTVJSVmZJZFdEVzM3eWRXTGlJMEMtT1ljUUl4UVBTZHpBY0pTR1VmSUZLVnVnUkNhT19fOEJoZjFITU9mVUtoQWFKUmpRSl80UkpXdGUyOTktd3hMSGI5aFhTdzNoWk1xOC1WeHVZeXVDQU93bERQbGZyM3FGUXlBdENLSndjVEdfX2Y1MTJmNW9JcjVWRTMwOCJdLCJhc3NlcnRpb24iOiJleUpoYkdjaU9pSlNVelkwSW4wLmV5SmxlSEFpT2pFek1qRTFOall5TmprMU5EWXNJbUYxWkNJNkltaDBkSEJ6T2k4dmJYbGhjSEJ6TG0xdmVtbHNiR0ZzWVdKekxtTnZiU0o5LkNoM2ZodzN0X09yMHAwOXhmU0FzakFlcnpObW50bDlyTzlaNDN1azd5NTRndTBIZVY2SXFFZTAxN0ZBc09TUktXU0FDdjNsUDhiZmhtUXM3OHJuNDNRIn0"""

class TestUtil(unittest.TestCase):

    def test_decode(self):
        decode = json.loads(urlb64decode(assertion))
        keys = decode.keys()
        keys.sort()
        self.assertEqual(keys, ['assertion', 'certificates'])
